@using System.Security;
@using System.Net;
@using SharedLib;
@using BlazorLib;

@inherits BlazorBusyComponentBaseModel

@if (IsBusyProgress)
{
    <MudProgressLinear Color="Color.Primary" Indeterminate="true" Class="my-3" />
}

<MudStack Row="true">
    <MudSelect Disabled="@(SelectedPortfolioId == 0)" T="int" @bind-Value="SelectedPortfolioId" Label="Портфель" Variant="Variant.Outlined">
        @if (myPortfolios is not null && myPortfolios.Count() != 0)
        {
            @foreach (PortfolioStockSharpViewModel p in myPortfolios)
            {
                <MudSelectItem T="int" Value="p.Id">
                    @p.ToString()
                </MudSelectItem>
            }
        }
    </MudSelect>
    <MudSelect @bind-Value="SelectedOrderType" Label="Тип" Variant="Variant.Outlined">
        @foreach (OrderTypesEnum margin in Enum.GetValues(typeof(OrderTypesEnum)).Cast<OrderTypesEnum>())
        {
            <MudSelectItem Value="margin">@margin</MudSelectItem>
        }
    </MudSelect>
    <MudSelect @bind-Value="orderSideCreate" Label="Направление" Variant="Variant.Outlined">
        @foreach (SidesEnum margin in Enum.GetValues(typeof(SidesEnum)).Cast<SidesEnum>())
        {
            <MudSelectItem Value="margin">@margin</MudSelectItem>
        }
    </MudSelect>
    <MudNumericField @bind-Value="PriceNewOrder" Label="Цена" Variant="Variant.Outlined" Immediate />
    <MudNumericField @bind-Value="VolumeNewOrder" Label="Объём" Variant="Variant.Outlined" Immediate />
    <MudFab Color="Color.Secondary" StartIcon="@Icons.Material.Filled.Add" OnClick="NewOrder" Disabled="@(PriceNewOrder <= 0)" />
</MudStack>